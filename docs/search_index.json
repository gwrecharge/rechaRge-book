[["index.html", "A Minimal Book Example Chapter 1 Prerequisites", " A Minimal Book Example Yihui Xie 2024-02-08 Chapter 1 Prerequisites This is a sample book written in Markdown. You can use anything that Pandoc’s Markdown supports, e.g., a math equation \\(a^2 + b^2 = c^2\\). The bookdown package can be installed from CRAN or Github: install.packages(&quot;bookdown&quot;) # or the development version # devtools::install_github(&quot;rstudio/bookdown&quot;) Remember each Rmd file contains one and only one chapter, and a chapter is defined by the first-level heading #. To compile this example to PDF, you need XeLaTeX. You are recommended to install TinyTeX (which includes XeLaTeX): https://yihui.name/tinytex/. "],["intro.html", "Chapter 2 Introduction", " Chapter 2 Introduction You can label chapter and section titles using {#label} after them, e.g., we can reference Chapter 2. If you do not manually label them, there will be automatic labels anyway, e.g., Chapter 4. Figures and tables with captions will be placed in figure and table environments, respectively. par(mar = c(4, 4, .1, .1)) plot(pressure, type = &#39;b&#39;, pch = 19) Figure 2.1: Here is a nice figure! Reference a figure by its code chunk label with the fig: prefix, e.g., see Figure 2.1. Similarly, you can reference tables generated from knitr::kable(), e.g., see Table 2.1. knitr::kable( head(iris, 20), caption = &#39;Here is a nice table!&#39;, booktabs = TRUE ) Table 2.1: Here is a nice table! Sepal.Length Sepal.Width Petal.Length Petal.Width Species 5.1 3.5 1.4 0.2 setosa 4.9 3.0 1.4 0.2 setosa 4.7 3.2 1.3 0.2 setosa 4.6 3.1 1.5 0.2 setosa 5.0 3.6 1.4 0.2 setosa 5.4 3.9 1.7 0.4 setosa 4.6 3.4 1.4 0.3 setosa 5.0 3.4 1.5 0.2 setosa 4.4 2.9 1.4 0.2 setosa 4.9 3.1 1.5 0.1 setosa 5.4 3.7 1.5 0.2 setosa 4.8 3.4 1.6 0.2 setosa 4.8 3.0 1.4 0.1 setosa 4.3 3.0 1.1 0.1 setosa 5.8 4.0 1.2 0.2 setosa 5.7 4.4 1.5 0.4 setosa 5.4 3.9 1.3 0.4 setosa 5.1 3.5 1.4 0.3 setosa 5.7 3.8 1.7 0.3 setosa 5.1 3.8 1.5 0.3 setosa You can write citations, too. For example, we are using the bookdown package (Xie 2023) in this sample book, which was built on top of R Markdown and knitr (Xie 2015). References "],["literature.html", "Chapter 3 Literature", " Chapter 3 Literature Here is a review of existing methods. "],["methods.html", "Chapter 4 Methods 4.1 math example", " Chapter 4 Methods We describe our methods in this chapter. Math can be added in body using usual syntax like this 4.1 math example \\(p\\) is unknown but expected to be around 1/3. Standard error will be approximated \\[ SE = \\sqrt(\\frac{p(1-p)}{n}) \\approx \\sqrt{\\frac{1/3 (1 - 1/3)} {300}} = 0.027 \\] You can also use math in footnotes like this1. We will approximate standard error to 0.0272 where we mention \\(p = \\frac{a}{b}\\)↩︎ \\(p\\) is unknown but expected to be around 1/3. Standard error will be approximated \\[ SE = \\sqrt(\\frac{p(1-p)}{n}) \\approx \\sqrt{\\frac{1/3 (1 - 1/3)} {300}} = 0.027 \\]↩︎ "],["example.html", "Chapter 5 Example 5.1 HydroBudget model", " Chapter 5 Example Load the rechaRge library. library(rechaRge) 5.1 HydroBudget model 5.1.1 Input data and parameters Load the input data for the simulation. base_url &lt;- &quot;https://github.com/gwrecharge/rechaRge-book/raw/main/examples/input/&quot; input_rcn &lt;- paste0(base_url, &quot;rcn.csv.gz&quot;) # RCN values per RCN cell ID input_climate &lt;- paste0(base_url, &quot;climate.csv.gz&quot;) # precipitation total in mm/d per climate cell ID input_rcn_climate &lt;- paste0(base_url, &quot;rcn_climate.csv.gz&quot;) # relation between climate and RCN cell IDs input_rcn_gauging &lt;- paste0(base_url, &quot;rcn_gauging.csv.gz&quot;) # relation between gaugins station and RCN cell IDs input_observed_flow &lt;- paste0(base_url, &quot;observed_flow.csv.gz&quot;) # flow rates in mm/d input_alpha_lyne_hollick &lt;- paste0(base_url, &quot;alpha_lyne_hollick.csv.gz&quot;) Set the HydroBudget model with the parameters values: HB &lt;- rechaRge::new_hydrobugdet( T_m = 2.1, # melting temperature (°C) C_m = 6.2, # melting coefficient (mm/°C/d) TT_F = -17.6, # Threshold temperature for soil frost (°C) F_T = 16.4, # Freezing time (d) t_API = 3.9, # Antecedent precipitation index time (d) f_runoff = 0.63, # Runoff factor (-) sw_m = 431, # Maximum soil water content (mm) f_inf = 0.07 # infiltration factor (-) ) Set the column names mappings matching the input datasets: HB$rcn_columns &lt;- list( rcn_id = &quot;cell_ID&quot;, RCNII = &quot;RCNII&quot;, lon = &quot;X_L93&quot;, lat = &quot;Y_L93&quot; ) HB$climate_columns$climate_id &lt;- &quot;climate_cell&quot; HB$rcn_climate_columns &lt;- list( climate_id = &quot;climate_cell&quot;, rcn_id = &quot;cell_ID&quot; ) HB$rcn_gauging_columns &lt;- list( rcn_id = &quot;cell_ID&quot;, station_id = &quot;gauging_stat&quot; ) HB$alpha_lyne_hollick_columns$station_id &lt;- &quot;station&quot; Set the simulation period: simul_period &lt;- c(2010, 2017) 5.1.2 Simulation Compute the water budget using the HydroBudget model: water_budget &lt;- rechaRge::compute_recharge( HB, rcn = input_rcn, climate = input_climate, rcn_climate = input_rcn_climate, period = simul_period ) The water budget data set is per year-month in each RCN cell: vi, the vertical inflow t_mean, the mean temperature runoff, the runoff pet, the potential evapotranspiration aet, the actual evapotranspiration gwr, the ground water recharge runoff_2, the excess runoff The head of this data set is: year month vi t_mean runoff pet aet gwr runoff_2 delta_reservoir rcn_id 2010 1 28.2 -7.3 21.5 1.6 1.6 10.2 0 -5.1 62097 2010 2 27.9 -5.7 7.9 4.6 4.6 8.8 0 6.6 62097 2010 3 83.0 1.0 30.8 19.5 19.5 16.1 0 16.6 62097 2010 4 68.2 7.7 24.9 51.5 51.5 15.1 0 -23.3 62097 2010 5 46.9 13.8 3.8 94.7 73.8 4.4 0 -35.2 62097 2010 6 107.9 17.0 33.3 114.7 81.1 0.2 0 -6.7 62097 5.1.3 Quality assessment Process the river flow observations and assess simulation quality: result &lt;- rechaRge::compute_simulation_quality_assessment( HB, water_budget = water_budget, rcn_gauging = input_rcn_gauging, observed_flow = input_observed_flow, alpha_lyne_hollick = input_alpha_lyne_hollick, period = simul_period ) 5.1.4 Results handling Save the simulation results: sim_dir &lt;- file.path(tempdir(), paste0(&quot;simulation_HydroBudget_&quot;, format(Sys.time(), &quot;%Y%m%dT%H_%M&quot;))) # Write output files # CSV rechaRge::write_recharge_results(HB, water_budget, output_dir = sim_dir) # NetCDF rechaRge::write_recharge_results(HB, water_budget, output_dir = sim_dir, format = &quot;nc&quot;, input_rcn = input_rcn, names = list( &quot;lon&quot; = list( longname = &quot;Qc lambert NAD83 epsg32198 Est&quot;, unit = &quot;m&quot; ), &quot;lat&quot; = list( longname = &quot;Qc lambert NAD83 epsg32198 North&quot;, unit = &quot;m&quot; ) )) # Rasters rechaRge::write_recharge_rasters( HB, water_budget = water_budget, input_rcn = input_rcn, crs = &quot;+proj=lcc +lat_1=60 +lat_2=46 +lat_0=44 +lon_0=-68.5 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs&quot;, output_dir = sim_dir ) # List simulation output files list.files(sim_dir) ## [1] &quot;bilan_spat_month.csv&quot; &quot;bilan_unspat_month.csv&quot; ## [3] &quot;interannual_aet_NAD83.tif&quot; &quot;interannual_gwr_NAD83.tif&quot; ## [5] &quot;interannual_runoff_NAD83.tif&quot; &quot;water_budget.nc&quot; 5.1.5 Data visualization Visualize the saved raster files: library(tidyterra) library(terra) library(ggplot2) library(cowplot) subtitle &lt;- ifelse(simul_period[1] == simul_period[2], paste0(&quot;In &quot;, simul_period[1]), paste0(&quot;From &quot;, simul_period[1], &quot; to &quot;, simul_period[2]) ) runoff &lt;- terra::rast(file.path(sim_dir, &quot;interannual_runoff_NAD83.tif&quot;)) runoffplot &lt;- ggplot() + geom_spatraster(data = runoff) + scale_fill_viridis_c(option = &quot;inferno&quot;) + labs( fill = &quot;&quot;, title = &quot;Runoff&quot;, subtitle = subtitle ) aet &lt;- terra::rast(file.path(sim_dir, &quot;interannual_aet_NAD83.tif&quot;)) aetplot &lt;- ggplot() + geom_spatraster(data = aet) + scale_fill_viridis_c(option = &quot;inferno&quot;) + labs( fill = &quot;&quot;, title = &quot;Actual Evapotranspiration&quot;, subtitle = subtitle ) gwr &lt;- terra::rast(file.path(sim_dir, &quot;interannual_gwr_NAD83.tif&quot;)) gwrplot &lt;- ggplot() + geom_spatraster(data = gwr) + scale_fill_viridis_c(option = &quot;inferno&quot;) + labs( fill = &quot;&quot;, title = &quot;Ground Water Recharge&quot;, subtitle = subtitle ) cowplot::plot_grid(runoffplot, aetplot, gwrplot) "],["final-words.html", "Chapter 6 Final Words", " Chapter 6 Final Words We have finished a nice book. "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
